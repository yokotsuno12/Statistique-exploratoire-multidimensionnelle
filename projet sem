libname projet "/home/u59481623/projet";

/* PROJET SEM - Chaima Abdellali; Léo Déchaumet; Pépita Kenesi Laurent - */




/* Question 1 : On importe les données */
/*PROC IMPORT file = "/home/u59521311/projet final/don2.sas7bdat" out = projet.don dbms=tab ;
run;

PROC IMPORT file = "/home/u59521311/projet final/log.sas7bdat" out = projet.log dbms=tab ;
run;*/ /*Remarque : c'est la transposée de projet.don*/ 

/* On prépare les formats pour la question 2*/

data projet.don3;
set projet.don2;
if item=. then newid = var; else newid = CATX('_' , var,item);
drop var;
drop item;
run;

proc transpose data=projet.don3 out=projet.don2_transpose(drop=_name_);
by nuq;
id newid;
run;

proc format;
	value rdeux 1="Male" 2="Female";
run;

proc format;
	value rcinq 1="Never" 2="Less often" 3="Once every 4 to 6 months"
	4="Once every 2 or 3 months" 5="1 to 3 times per month"
	6="1 to 4 times per week" 7="Almost every day or more often";
run;

/* Questions 2 et 3 : On modifie les formats et on ajoute la variable tranche_age dans le data */
data projet.don_formated ;
format r2 rdeux. ; 
format r5 rcinq. ;
set projet.don2_transpose;
length tranche_age $5;
select ; 
when (r3<35) tranche_age="20-34";
when (34<r3 and r3<50) tranche_age="35-49";
otherwise tranche_age="50-65"; 
end; 
run;

/*Question 4*/

/*Répartition de l'échantillon en age : */
proc sgplot data=projet.don_formated;
   histogram r3;
   title "Répartition selon l'age";
run;


/*Répartition de l'échantillon selon le sexe*/
proc sgplot data=projet.don_formated;
   histogram r2;
   title "Répartition selon le sexe";
run;

/*Répartition de l'échantillon selon le revenu annuel*/

proc sgplot data=projet.don_formated;
   histogram r12;
   title "Répartition selon le revenu annuel";
run;

/*Répartition de l'échantillon selon le statut marital*/

proc sgplot data=projet.don_formated;
   histogram r13;
   title "Répartition selon le statut marital";
run;

/*Répartition de l'échantillon selon la présence d'enfants*/

proc sgplot data=projet.don_formated;
   histogram r14;
   title "Répartition selon la présence d'enfants";
run;

/*Question 5*/

proc sgplot data=projet.don_formated;
histogram R2;
title "repartition homme femme";
run;

proc freq data=projet.don_formated;
tables r2 * cognac / cellchi2 chisq nocol nofreq;
run;
/*a. Les hommes et les femmes consomment-ils de la même façon du cognac ?
Réponse : On remarque que les hommes consomment en moyenne plus souvent du cognac que les femmes: 
On a environ 49 % de réponses positives chez les hommes et 45% de réponses positives chez les femmes. 
Donc environ 4% d'écart : mais est-ce représentatif ? On a 26.14 % de femmes sur 264 personnes qui ont répondu au questionnaire, ce qui représente 69 personnes. */

proc freq data=projet.don_formated;
tables tranche_age * cognac / cellchi2 chisq nocol nofreq;
run;

proc format;
value prob_achat 1=0 2=0 3=0 4=0.7 5=1;
run;

data projet.don_ia1 (keep=ia1_:);
set projet.don_formated;
format ia1_: prob_achat.;
run;

proc factor data=projet.don_ia1 R=V;
